{"ast":null,"code":"var _jsxFileName = \"/home/al/DEVELOPPEMENT/MyEvent2021/frontend/src/screens/HomePage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { Row, Col, Container, Dropdown } from \"react-bootstrap\";\nimport GetGeoLocation from \"../components/GetGeoLocation\";\nimport CityList from \"../components/CityList\"; // import MyNav from '../Components/navBar';\n\nimport '../App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction HomePage() {\n  _s();\n\n  const [events, setEvents] = useState(false);\n  const [eventsFiltred, setEventsFiltred] = useState([]);\n  const [filtredEventsActive, setFiltredEventsActive] = useState(false);\n  const [autoriseGps, SetAutoriseGps] = useState(false);\n  const gps = GetGeoLocation();\n  const [city, setCity] = useState(false);\n  const [dataTags, setDataTags] = useState([]);\n  /* const [token, setToken] = useState(false);\n    const handleChange = ({ currentTarget }) => {\n     const { name, value } = currentTarget;\n     setMessage({ ...message, [name]: value });\n   };\n    const [isMobile, setIsMobile] = useState(false)\n  \n   //choose the screen size \n   const handleResize = () => {\n     window.innerWidth <= 768 ? setIsMobile(true) : setIsMobile(false)\n   }\n    // create an event listener\n   useEffect(() => {\n     window.addEventListener(\"resize\", handleResize)\n   })*/\n\n  useEffect(() => {// getEvent();\n\n    /* let token = (JSON.parse(window.localStorage.getItem(\"userInfo\")).token);\n     if(token){\n       setToken(token);\n       console.log(token);\n       getSeries(token)\n       setLoading(false);\n     }else{\n       // pas de user\n     }*/\n  }, []);\n  /* <p>Position : { gps.loaded && gps.error && gps.error.message &&\n     <p>La géolocalisation est imposible</p>\n     ||\n     <p>{JSON.stringify(gps.coordinates.lat)} : {JSON.stringify(gps.coordinates.lng)}</p>\n     }\n      </p>*/\n\n  const getEventByCoord = async () => {\n    try {\n      const response = await axios.get(\"https://public.opendatasoft.com/api/records/1.0/search/?dataset=evenements-publics-cibul&q=&geofilter.distance=\" + gps.coordinates.lat + \"%2C+\" + gps.coordinates.lng + \"%2C100000\"); //   console.log(response.data);\n\n      console.log(response.data.records);\n      setEvents(response.data.records);\n      var tempo = \"\";\n      response.data.records.forEach(element => {\n        tempo = tempo + element.fields.tags;\n        tempo = tempo + \",\";\n      });\n      tempo = tempo.replaceAll(',,', ',');\n      tempo = tempo.replaceAll(',undefined', '');\n      let array = tempo.split(','); //Todo erase double\n\n      setDataTags(array);\n    } catch (error) {\n      console.log(error.response);\n    }\n  };\n\n  const getPossition = () => {\n    console.log(gps);\n\n    if (gps.loaded == false) {\n      alert(\"veuillez d'abors accepter ou refuser le partage de vos coordoner\");\n    } else {\n      if (gps.error) {\n        console.log(gps.error.message);\n        alert(\"Vos avez refusser le partage de coordonee, vous pouvez malgre tout chercher les evenment par les filtres, si c'est une errur recharger la page\");\n      } else {\n        console.log(gps.coordinates.lat);\n        console.log(gps.coordinates.lng);\n        getEventByCoord();\n      }\n    }\n  };\n\n  const validFilter = () => {\n    console.log(city);\n  };\n\n  const onchangeListCity = data => {\n    setCity(data);\n    console.log(data);\n  };\n\n  const filtreType = e => {\n    if (e.target.value !== \"null\") {\n      const arrayTempo = [];\n      events.forEach(event => {\n        if (event.fields.tags) {\n          arrayTempo.push(event);\n        }\n      }); //   console.log(arrayTempo)\n\n      const result = arrayTempo.filter((event, i) => event.fields.tags.includes(e.target.value));\n      console.log(result);\n      setEventsFiltred(result);\n      setFiltredEventsActive(true);\n    } else {\n      setEventsFiltred(events);\n    }\n  };\n\n  const letsFiltre = data => {};\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"back-red\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => getPossition(),\n        children: \"les evenements autour de moi\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"eventAvenir\",\n        children: \"Ev\\xE9nements \\xE0 venir\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 5\n      }, this), gps.loaded && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          children: \"Filtres\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          for: \"typeFiltre-select\",\n          children: \"Choisissez un type d'evenement : \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"typeFiltre-select\",\n          onChange: filtreType,\n          children: [gps && gps.loaded && dataTags.map(data => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: data,\n            children: data\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 11\n          }, this)), /*#__PURE__*/_jsxDEV(\"option\", {\n            value: \"null\",\n            children: \"-- Tous --\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true) || /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Recherches\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(CityList, {\n          data: city,\n          onchange: e => {\n            onchangeListCity(e);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => validFilter(),\n          children: \"Recherchez\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      children: filtredEventsActive && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: eventsFiltred.map(event => /*#__PURE__*/_jsxDEV(Row, {\n          className: \"events-list-container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"events-list\",\n            children: [/*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(\"h4\", {\n                className: \"desc\",\n                children: event.fields.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 168,\n                columnNumber: 20\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"gras\",\n                children: \"Dates :\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 20\n              }, this), \" \", event.fields.date_start, \" ~ \", event.fields.date_end]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 169,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Col, {\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"gras\",\n                children: \"Localit\\xE9 :\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 21\n              }, this), \" \", event.fields.city]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 170,\n              columnNumber: 15\n            }, this), event.fields.image && /*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: event.fields.image,\n                alt: \"photo de l'event\",\n                width: \"250\",\n                height: \"200\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 15\n            }, this) || /*#__PURE__*/_jsxDEV(Col, {\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: require('../defaultposter.png'),\n                alt: \"\",\n                width: \"250\",\n                height: \"200\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 174,\n                columnNumber: 20\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: event.fields.free_text\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this))\n      }, void 0, false) || /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: events && events.map(event => /*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            className: \"back-green\",\n            children: [\"Adress :\", event.fields.city]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this), event.fields.image && /*#__PURE__*/_jsxDEV(Col, {\n            className: \"back-green\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: event.fields.image,\n              alt: \"\",\n              width: \"250\",\n              height: \"200\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 41\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 13\n          }, this) || /*#__PURE__*/_jsxDEV(Col, {\n            className: \"back-green\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: require('../defaultposter.png'),\n              alt: \"\",\n              width: \"250\",\n              height: \"200\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 41\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }, this))\n      }, void 0, false)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 3\n  }, this);\n}\n\n_s(HomePage, \"rp/W7rH9ZNda+PyjqN/pYsPn4CY=\");\n\n_c = HomePage;\nexport default HomePage;\n\nvar _c;\n\n$RefreshReg$(_c, \"HomePage\");","map":{"version":3,"sources":["/home/al/DEVELOPPEMENT/MyEvent2021/frontend/src/screens/HomePage.js"],"names":["React","useState","useEffect","axios","Row","Col","Container","Dropdown","GetGeoLocation","CityList","HomePage","events","setEvents","eventsFiltred","setEventsFiltred","filtredEventsActive","setFiltredEventsActive","autoriseGps","SetAutoriseGps","gps","city","setCity","dataTags","setDataTags","getEventByCoord","response","get","coordinates","lat","lng","console","log","data","records","tempo","forEach","element","fields","tags","replaceAll","array","split","error","getPossition","loaded","alert","message","validFilter","onchangeListCity","filtreType","e","target","value","arrayTempo","event","push","result","filter","i","includes","letsFiltre","map","description","date_start","date_end","image","require","free_text"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { Row, Col, Container , Dropdown} from \"react-bootstrap\";\nimport GetGeoLocation from \"../components/GetGeoLocation\";\nimport CityList from \"../components/CityList\";\n\n// import MyNav from '../Components/navBar';\nimport '../App.css';\n\nfunction HomePage() {\n  const [events, setEvents] = useState(false);\n  const [eventsFiltred, setEventsFiltred] = useState([]);\n  const [filtredEventsActive, setFiltredEventsActive] = useState(false);\n\n  \n\n  const [autoriseGps, SetAutoriseGps] = useState(false);\n  const gps = GetGeoLocation();\n  const [city, setCity] = useState(false);\n  const [dataTags, setDataTags] = useState([]);\n  \n /* const [token, setToken] = useState(false);\n\n  const handleChange = ({ currentTarget }) => {\n    const { name, value } = currentTarget;\n    setMessage({ ...message, [name]: value });\n  };\n\n  const [isMobile, setIsMobile] = useState(false)\n \n  //choose the screen size \n  const handleResize = () => {\n    window.innerWidth <= 768 ? setIsMobile(true) : setIsMobile(false)\n  }\n\n  // create an event listener\n  useEffect(() => {\n    window.addEventListener(\"resize\", handleResize)\n  })*/\n\n  useEffect(() => {\n   // getEvent();\n   /* let token = (JSON.parse(window.localStorage.getItem(\"userInfo\")).token);\n    if(token){\n      setToken(token);\n      console.log(token);\n      getSeries(token)\n      setLoading(false);\n    }else{\n      // pas de user\n    }*/\n  }, []);\n /* <p>Position : { gps.loaded && gps.error && gps.error.message &&\n    <p>La géolocalisation est imposible</p>\n    ||\n    <p>{JSON.stringify(gps.coordinates.lat)} : {JSON.stringify(gps.coordinates.lng)}</p>\n    }\n\n    </p>*/\n\n  const getEventByCoord = async () => {\n    try {\n      const response = await axios.get(\"https://public.opendatasoft.com/api/records/1.0/search/?dataset=evenements-publics-cibul&q=&geofilter.distance=\"+gps.coordinates.lat+\"%2C+\"+gps.coordinates.lng+\"%2C100000\");\n   //   console.log(response.data);\n      console.log(response.data.records);\n      setEvents(response.data.records)\n      var tempo = \"\";\n      response.data.records.forEach((element) => {\n        tempo = tempo + element.fields.tags;\n        tempo = tempo + \",\";\n      });\n      tempo = tempo.replaceAll(',,', ',');\n      tempo = tempo.replaceAll(',undefined', '');\n      let array = tempo.split(',');\n      //Todo erase double\n      setDataTags(array);\n\n    } catch (error) {\n      console.log(error.response);\n    }\n  }\n\n  const getPossition = () => {\n    console.log(gps)\n    if (gps.loaded == false) {\n      alert(\"veuillez d'abors accepter ou refuser le partage de vos coordoner\")\n    }else{\n      if (gps.error) {\n        console.log(gps.error.message)\n        alert(\"Vos avez refusser le partage de coordonee, vous pouvez malgre tout chercher les evenment par les filtres, si c'est une errur recharger la page\")\n      }\n      else{\n        console.log(gps.coordinates.lat)\n        console.log(gps.coordinates.lng)\n        getEventByCoord()\n      }\n    }\n  }\n  const validFilter = () => {\n    console.log(city);\n  }\n\n  const onchangeListCity = (data) => {\n    setCity(data)\n    console.log(data);\n  }\n\n  const filtreType = (e) => {\n    if (e.target.value !== \"null\") {\n        const arrayTempo = []\n        events.forEach((event) => {\n          if (event.fields.tags) {\n            arrayTempo.push(event);\n          }\n        });\n    //   console.log(arrayTempo)\n        const result = arrayTempo.filter((event, i) => \n            event.fields.tags.includes(e.target.value)\n        );\n        console.log(result);\n        setEventsFiltred(result);\n        setFiltredEventsActive(true);\n    }else{\n      setEventsFiltred(events);\n    }\n  }\n\n\n\n  const letsFiltre = (data) => {\n\n  }\n  return (\n  <div>\n    <div className=\"back-red\">\n      <button onClick={()=> getPossition()}>les evenements autour de moi</button>\n    </div>\n\n    <div>\n    <h1 className=\"eventAvenir\">Evénements à venir</h1>\n      {gps.loaded &&\n      <>\n      <h4>Filtres</h4>\n      <label for=\"typeFiltre-select\">Choisissez un type d'evenement : </label>\n      <select name=\"typeFiltre-select\" onChange={filtreType}>\n        {gps && gps.loaded && dataTags.map((data) =>\n          <option value={data}>{data}</option>\n        )}\n        <option value=\"null\">-- Tous --</option>\n      </select>\n      </>\n      ||\n      <>\n        <h2>Recherches</h2>\n        <CityList data={city} onchange={(e) => { onchangeListCity(e) }}/>\n        <button onClick={()=> validFilter()}>Recherchez</button>\n      </>\n      }\n    </div>\n\n    <Container>\n      {filtredEventsActive &&\n      <>\n        {eventsFiltred.map((event) =>\n\n          <Row className='events-list-container'>\n            <div className='events-list'>\n              <Col><h4 className='desc'>{event.fields.description}</h4></Col>\n              <Col><span className='gras'>Dates :</span> {event.fields.date_start} ~ {event.fields.date_end}</Col>\n              <Col ><span className='gras'>Localité :</span> {event.fields.city}</Col>\n              {event.fields.image &&\n              <Col ><img src={event.fields.image} alt=\"photo de l'event\" width=\"250\" height=\"200\" /></Col>\n              ||\n              <Col><img src={require('../defaultposter.png')} alt=\"\" width=\"250\" height=\"200\" /></Col>\n              }\n              <p>{event.fields.free_text}</p>\n            </div>\n          </Row>\n        )}\n      </>\n      ||\n      <>\n        {events && events.map((event) =>\n          <Row>\n            <Col className=\"back-green\">Adress :{event.fields.city}</Col>\n            {event.fields.image &&\n            <Col className=\"back-green\"><img src={event.fields.image} alt=\"\" width=\"250\" height=\"200\" /></Col>\n            ||\n            <Col className=\"back-green\"><img src={require('../defaultposter.png')} alt=\"\" width=\"250\" height=\"200\" /></Col>\n            }\n          </Row>\n        )}\n      </>\n      }\n\n  </Container>\n\n\n  </div>       \n  );\n}\n\nexport default HomePage;"]},"metadata":{},"sourceType":"module"}